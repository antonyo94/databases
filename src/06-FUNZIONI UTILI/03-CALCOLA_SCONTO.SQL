--FUNZIONE DI BASE 2
--Utile nel calcolare lo sconto applicato in base al numero dei figli iscritti da parte di ogni genitore

CREATE OR REPLACE FUNCTION CALCOLA_SCONTO(VALORE NUMBER,SCONTO NUMBER) RETURN NUMBER IS
RESULT NUMBER;
NEGATIVO EXCEPTION;
BEGIN
IF VALORE<0 OR SCONTO <0 THEN 
	RAISE NEGATIVO;
END IF;

IF SCONTO=1 THEN
RETURN VALORE;
ELSE 
SELECT VALORE*(1-(0.5*SCONTO/10)) INTO RESULT
FROM DUAL;
IF RESULT<25 THEN
	RESULT:=25;
END IF;
RETURN RESULT;
END IF;

EXCEPTION 
WHEN NEGATIVO THEN
	RAISE_APPLICATION_ERROR(-20111,'Non sono ammessi valori negativi per applicare lo sconto!');
END;