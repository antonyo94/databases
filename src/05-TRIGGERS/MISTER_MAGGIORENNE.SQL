--TRIGGER 8
--Viene controllata l'età dei nuovi mister che verosimilmente non può essere minore di 18 anni.

CREATE OR REPLACE TRIGGER MISTER_MAGGIORENNE
BEFORE INSERT ON MISTER
FOR EACH ROW

DECLARE
ANNI_M NUMBER;
MINORENNE EXCEPTION;

BEGIN 
SELECT OTTIENI_ETA(:NEW.DATA_N_M) INTO ANNI_M
FROM DUAL;
IF ANNI_M < 18 THEN
	RAISE MINORENNE;
END IF;

EXCEPTION
WHEN MINORENNE THEN
RAISE_APPLICATION_ERROR(-20004,'Non possono essere assunti mister minorenni');
END;