DROP TABLE ALLENAMENTO;

--ALLENAMENTO
CREATE TABLE ALLENAMENTO(
DATA_ALL DATE,
N_PATENTINO_ALLENAMENTO CHAR(7),
CATEGORIA_S_ALLENAMENTO VARCHAR2(15),
ETA_S_ALLENAMENTO NUMBER(2,0) ,
DURATA NUMBER(3,0) NOT NULL,
CONSTRAINT ALLENAMENTO_PK PRIMARY KEY(DATA_ALL),
CONSTRAINT ALLENAMENTO_FK_1 FOREIGN KEY (N_PATENTINO_ALLENAMENTO) REFERENCES MISTER(N_PATENTINO),
CONSTRAINT ALLENAMENTO_FK_2 FOREIGN KEY (CATEGORIA_S_ALLENAMENTO,ETA_S_ALLENAMENTO) REFERENCES SQUADRA(CATEGORIA_S,ETA_S),
CONSTRAINT CONTROLLO_ETA_ALL CHECK((ETA_S_ALLENAMENTO>=5 AND ETA_S_ALLENAMENTO<7 AND UPPER(CATEGORIA_S_ALLENAMENTO)IN 'PICCOLI AMICI') OR 
								  (ETA_S_ALLENAMENTO>=7 AND ETA_S_ALLENAMENTO<9 AND UPPER(CATEGORIA_S_ALLENAMENTO) IN('PULCINI'))      OR 
							 	  (ETA_S_ALLENAMENTO>=9 AND ETA_S_ALLENAMENTO<12 AND UPPER(CATEGORIA_S_ALLENAMENTO)IN 'ESORDIENTI')    OR 
							 	  (ETA_S_ALLENAMENTO>=12 AND ETA_S_ALLENAMENTO<=14 AND UPPER(CATEGORIA_S_ALLENAMENTO)IN 'GIOVANISSIMI')),
CONSTRAINT VERIFICA_INS_ORA CHECK(TO_CHAR(DATA_ALL,'DD-MM-YYYY HH24:MI:SS') NOT LIKE '%00:00:00'),
CONSTRAINT MAX_DURATA CHECK(DURATA<=120)
);